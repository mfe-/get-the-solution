<h1 id="signal-processing-introduction">Signal Processing introduction</h1>
<p>This text is from the category <a href="category/sip">SIP (Signal and image proccessing)</a>.</p>
<p>A signal is defined as any physical or virtual quantity that varies with time or space or any other independent variable.</p>
<p>Expressing a signal in a mathematically way, it can be written as a function of an independent variable which varies <em>for example</em> in time.</p>
<p>Signal in continuous time domain are notated</p>
<p><span class="math inline">\(x(t), 0 ≤ t ≤ T\)</span></p>
<p>Signal in discrete time domain are notated</p>
<p><span class="math inline">\(x[n], n = 0, 1, · · · , N\)</span></p>
<p>Signals occur in different environments and are therefore categorized into the continuous time domain and discrete time domain.</p>
<p>Example Signals: Picture file (discrete), audio file (discrete), voltage, speech (continuous), temperature sensor, ...</p>
<p>Furthermore some signals are predictable and some or not.</p>
<ul>
<li>Deterministic signal
<ul>
<li>periodically (amplitude characteristics are repeating in time see sinus function)</li>
<li>none periodically
<ul>
<li>transient</li>
</ul></li>
</ul></li>
<li>Nondeterministic signal
<ul>
<li>stationary (probability distribution function or Probability density function are time independent)</li>
<li>non-stationary</li>
</ul></li>
</ul>
<h2 id="signals">Signals</h2>
<div class="figure">
<img src="assets/img/blog/sip/discrete_signal_example_t.png" alt="(Fig. 1 discrete x[n] (black) and continues signal x(t)(blue))" />
<p class="caption">(Fig. 1 discrete x[n] (black) and continues signal x(t)(blue))</p>
</div>
<p>There exists infinite types of signals and further more, signals can be composed of each other. Some special signals are that unique that they get there own name and are described in more detail like the Dirac delta function. As mentioned above there exists periodic signals. A signal is periodic if its repeats after a certain number of steps. Think of the sin(x) or cos(x) function.</p>
<p><span class="math inline">\(T...periodic\)</span></p>
<h2 id="discrete-signals">Discrete signals</h2>
<h3 id="impulse-signal---dirac-delta-function-for-discrete-signals">Impulse signal - Dirac delta function for discrete signals</h3>
<p>The delta function (or impulse signal) is defined for x[0]=1 and for all other position x[n]=0 (where n!=0).</p>
<div class="figure">
<img src="assets/img/blog/sip/delta_function.png" alt="(Fig 2. Dirac delta function or impulse function)" width="240" />
<p class="caption">(Fig 2. Dirac delta function or impulse function)</p>
</div>
<p><span class="math display">\[\delta[n]=\begin{cases}
1;n=0 \\
0;otherwise
\end{cases}
\]</span></p>
<p>With the delta function its possible to represent, for example the signal x[n] from figure 1, with a sum of delayed and scaled impulses.</p>
<h3 id="signal-transformations">Signal transformations</h3>
<h4 id="time-shifts-using-delta-function">Time shifts using delta function</h4>
<p>Transform signal <span class="math inline">\(x[n] -&gt; x[n-n_0]\)</span> where <span class="math inline">\(x[n]=delta[n]\)</span></p>
<p>See the following example with <span class="math inline">\(n_0\)</span>=1:</p>
<div class="figure">
<img src="assets/img/blog/sip/dt_delta_time_shift.png" alt="(Fig 3.)" width="480" />
<p class="caption">(Fig 3.)</p>
</div>
<p>The signal is shifted to the right by one which causes a delay.</p>
<h4 id="time-reversal">Time reversal</h4>
<p>Transform signal <span class="math inline">\(x[n] -&gt; x[-n]\)</span></p>
<p>See the following example:</p>
<div class="figure">
<img src="assets/img/blog/sip/dt_time_reversal.png" alt="(Fig 4.)" width="480" />
<p class="caption">(Fig 4.)</p>
</div>
<p>The signal got mirrored.</p>
<h4 id="scaling-using-delta-function">Scaling using delta function</h4>
<p>Transform signal <span class="math inline">\(x[n] -&gt; \alpha\cdot x[n-n_0] ; \alpha\in \mathbb{R}\)</span></p>
<div class="figure">
<img src="assets/img/blog/sip/dt_scale.png" alt="(Fig 5.)" width="480" />
<p class="caption">(Fig 5.)</p>
</div>
<h4 id="even-signals">Even signals</h4>
<p>Even signals are defined as <span class="math inline">\(x[n]=x[-n]\)</span> and are symmetric along the Y-Axes.</p>
<h4 id="odd-signals">Odd signals</h4>
<p>Odd signals are defined as <span class="math inline">\(x[-n]=-x[n]\)</span> and are symmetric along the diagonal.</p>
<p>Its always possible to write any signal as a combination of its even and odd parts. Its even parts can be computed by <span class="math inline">\(Even\{x[n]\}=\frac{1}{2}\cdot(x[n]+x[-n])\)</span> and its odds parts by <span class="math inline">\(Odd\{x[n]\}=\frac{1}{2}\cdot(x[n]-x[-n])\)</span>.</p>
<div class="figure">
<img src="assets/img/blog/sip/dt_even_odd_signal.png" alt="(Fig 6.)" width="480" />
<p class="caption">(Fig 6.)</p>
</div>
<h3 id="basis-signal">Basis signal</h3>
<p>With the above transformations and signal types we are able to describe signals with the impulse signal (dirac delta function).</p>
<p>See the following example: <span class="math inline">\(x[n]=(0,1,2,1,1,0,...)\)</span></p>
<div class="figure">
<img src="assets/img/blog/sip/dt_xn_basis.png" alt="(Fig 7.)" width="480" />
<p class="caption">(Fig 7.)</p>
</div>
<p><span class="math inline">\(x[n]=0\cdot\delta[n+3]+1\cdot\delta[n+2]+2\cdot\delta[n+1]+1\cdot\delta[n]+1\cdot\delta[n-1]+0\cdot\delta[n-2]+...\)</span></p>
<p>The above function is now described with explicit terms. We can write more generally:</p>
<p><span class="math inline">\(x[n]=\sum_{m=\infty}^\infty x[m]\cdot\delta[m-n]\)</span></p>
<p>Sources:</p>
<ul>
<li>[Signal and Image Processing lecture]</li>
<li><a href="http://www.songho.ca/dsp/convolution/convolution.html#decomposition">[http://www.songho.ca/dsp/convolution/convolution.html]</a></li>
</ul>
<h2 id="systems">Systems</h2>
<p>There exists signal processing systems which can process signals. They consist of a signal input, signal processing unit and signal output (Think of the IPO model).</p>
<p>A common wide known discrete-time system is the linear time-invariant (LTI) System. As the name says its linear and time-invariant <a href="http://slpl.cse.nsysu.edu.tw/cpchen/courses/dsp/basics-2.pdf">Source</a>. Of course there exists other systems which for example are time-variant. Currently we care only about the LTI-system.</p>
<p>This system describes in an abstract way what happens if we input a signal x[n] into a system which outputs y[n]. If the system is not a &quot;black box&quot;, so we know how the system is &quot;responding&quot; the response is often called h[n] (processing unit).</p>
<p>A linear time-invariant system has the following properties:</p>
<p>linearity:</p>
<ul>
<li>put in a signal scaled by coefficient a<em>x1[n] should output a</em>y1[n]</li>
<li>put in x1[n]+x2[n] should output y1[n]+y2[n] which means that it got shifted by the same amount as the input</li>
</ul>
<p>time invariant:</p>
<ul>
<li>shift in time the input x[t-a] should output y[t-a]</li>
</ul>
<p>This system can be described in generally as y[n]=x[n]*h[n] which is known as the convolution.</p>
<div class="figure">
<img src="assets/img/blog/sip/systems-lti.png" alt="(Fig 8.)" width="480" />
<p class="caption">(Fig 8.)</p>
</div>
<div class="figure">
<img src="assets/img/blog/sip/dt_system_lti.png" alt="(Fig 9.)" width="480" />
<p class="caption">(Fig 9.)</p>
</div>
<p>Any signal what you can give to a system (x[n]) is just an accumulation of delayed and scaled impulse. So if the LTI response to each of this delayed and scaled impulses with a impulse response h[n], then the output y[n] will be a scaled and delayed <strong>sum</strong> of impulse response. The formula for computing y[n] is the so called discrete-time convolution (operator asterisk).</p>
<p>General convolution defined by:</p>
<p><span class="math inline">\(y[n]=x[n]*y[n]\)</span></p>
<p>Convolution for a one dimensional signal</p>
<p><span class="math inline">\(y[n]=\sum_{k=\infty}^\infty x[k]\cdot h[n-k]\)</span></p>
<p>The convolution is done in 3 steps:</p>
<ul>
<li>flip one of the two signals</li>
<li>shift the flipped signal</li>
<li><p>move it from left to right x axis and calculate the overlapping sum</p></li>
<li>An LTI System is fully characterized by its impulse response</li>
<li>The convolution is symmetric <span class="math inline">\(x[n]*h[n]=h[n]*x[n]\)</span></li>
<li>System can also be characterized by difference equalisation
<ul>
<li><img src="assets/img/blog/sip/dt_system_lti_recursive.png" alt="(Fig 10.)" width="240" /></li>
<li><span class="math inline">\(y[n]=\sum_{l=1}^N a_l\cdot y[n-l]+\sum_{k=0}^u b_k \cdot x[n-k]\)</span></li>
<li>Often used when system impulse response is infinite</li>
</ul></li>
</ul>
<p>For the online convolution calculator click <a href="projects/discret-convolution">here</a></p>
<p>2d convolution is used for example in image processing. For more details checkout <a href="http://www.songho.ca/dsp/convolution/convolution.html#convolution_2d" class="uri">http://www.songho.ca/dsp/convolution/convolution.html#convolution_2d</a></p>
<h3 id="system-accumulator">System accumulator</h3>
<p><span class="math inline">\(y[n]=\sum_{k=-\infty}^n x[k]\)</span></p>
<h3 id="property-stable-system">Property stable system</h3>
<p>LTI systems are stable if the absolute sum of there impulse response is finite.</p>
<p><span class="math inline">\(y[n]=\sum_{n=-\infty}^\infty |h[n]| &lt; \infty\)</span></p>
<h3 id="property-causal-system">Property causal system</h3>
<p>We call a system causal iff <span class="math inline">\(h[n]=0 ,\forall n &lt;0\)</span></p>
<p>Example in fig 10 shows h[n] as causal and h`[n] as acausal.</p>
<div class="figure">
<img src="assets/img/blog/sip/acausal_sample.png" alt="(Fig 11.)" width="240" />
<p class="caption">(Fig 11.)</p>
</div>
<h2 id="discrete-time-fourier-transform">Discrete (time) Fourier Transform</h2>
<p>The Fourier transformation is named after Jean Baptiste Joseph Fourier (1768-1830), a French mathematician and physicist. His paper regarding the fourier transformation paper contained that any continuous periodic signal could be represented as the sum of properly chosen sinusoidal waves. This means that when applying the DFT to a signal, it assumes that the signal is periodic.</p>
<p>As a signal can be continuous or discrete and signals can be periodic or aperiodic will result in up to four categories. Lets focus on the discrete fourier transformation which is relevant for discret and periodic signals. [Source: The Scientist and Engineer's Guide to Digital Signal Processing]</p>
<p>With the discrete fourier transform signals can be transformed from real numbers (time domain) to the complex numbers (frequency domain). The transformation process from time domain to frequency domain is called <em>decomposition</em>, <em>analysis</em> or the <em>forward DFT</em>. Transforming from the frequency domain to the time domain is called <em>synthesis</em>, or the <em>inverse </em>DFT. Using the dft can help to perform certain task easier and do for example frequency domain analysis, compress signals or apply filters to signal (remove unwanted noise or filter for certain signal of interest).</p>
<p>A discrete signal in the time domain can be written as vector for example:</p>
<p>x[n]=(0,1,2,1,0,-1,-2,-1) N=8.</p>
<div class="figure">
<img src="assets/img/blog/sip/discrete_signal_example_dft.png" alt="(Fig 12. signal of x[n])" width="480" />
<p class="caption">(Fig 12. signal of x[n])</p>
</div>
<p>This signal of it can be rewritten as a sum of delta impulses as basis with its coefficients (linear combination with basis elements):</p>
<p><span class="math inline">\(x[n]=0\cdot\delta[n]+1\cdot\delta[n-1]+2\cdot\delta[n-2]+2\cdot\delta[n-2]+...\)</span></p>
<p>Bases allow one to represent vectors by a sequence of scalars called coordinates or components <a href="https://en.wikipedia.org/wiki/Vector_space#Basis_and_dimension">Source</a>.</p>
<p>In the frequency domain the k-th basis vector is a complex vector (where <span class="math inline">\(0\leq k\leq N-1\)</span>) defined as</p>
<p><span class="math inline">\(b_k[n]:=exp(j\frac{2\pi\cdot k}{N}\cdot n)\)</span></p>
<p>The basis vectors <span class="math inline">\(b_k\)</span> represent oscillations. We can write the signal using the basis vectors <span class="math inline">\(b_k\)</span> the same way as we did with the delta impulses. The coordinates X[k], with respect to this basis, can be calculated using the following equation (By convention the frequency domain is using Uppercase letters.):</p>
<p><span class="math inline">\(X[k]=\sum_{n=0}^{N-1} x[n]\cdot e^{-j\cdot\frac{2\pi\cdot k}{N}\cdot n} \qquad(analysis, dft, decomposition)\)</span></p>
<p>To transform not only the k-th element to the spectrum domain we need to compute discrete fourier transform over the whole vector with:</p>
<p><span class="math inline">\(X=(X[0], X[1],X[2], ..., X[N])\)</span></p>
<p>This means for the transformed X there exists N unique frequencies.</p>
<p>Moving back from the frequency domain to the time domain can be accomplished with:</p>
<p><span class="math inline">\(x[n]=\frac{1}{N}\cdot \sum_{k=0}^{N-1} X[k]\cdot e^{j\cdot\frac{2\pi\cdot k}{N}\cdot n} \qquad(inverse dft, synthesis)\)</span></p>
<p>This gives us the ability to reconstruct with the inverse dft the complete original signal.</p>
<p>For the signal of figure 12 we would do the following to calculate the dft.</p>
<p><span class="math inline">\(x[n]=(0,1,2,1,0,-1,-2,-1) N=8\)</span></p>
<p><span class="math inline">\(X[k]=\sum_{n=0}^{N-1} x[n]\cdot e^{-j\cdot\frac{2\pi\cdot k}{N}\cdot n} \qquad(analysis, dft, decomposition)\)</span></p>
<p><span class="math inline">\(X[0]=\sum_{n=0}^{7} x[n]\cdot e^{-j\cdot\frac{2\pi\cdot 0}{8}\cdot n}=0\cdot e^0+ 1\cdot e^0+ 2\cdot e^0+ 1\cdot e^0+ 0\cdot e^0- 1\cdot e^0- 2\cdot e^0- 1\cdot e^0=0\)</span></p>
<p><span class="math inline">\(X[1]=\sum_{n=0}^{7} x[n]\cdot e^{-j\cdot\frac{2\pi\cdot 1}{8}\cdot n}=0\cdot e^{-j\cdot\frac{2\pi\cdot 1}{8}\cdot 0}+1\cdot e^{-j\cdot\frac{2\pi\cdot 1}{8}\cdot 1}+2\cdot e^{-j\cdot\frac{2\pi\cdot 1}{8}\cdot 2}+1\cdot e^{-j\cdot\frac{2\pi\cdot 1}{8}\cdot 3}+...=0-6.82843i\)</span></p>
<!--- 
[wolframalpha](https://www.wolframalpha.com/input/?i=0*e%5E%28-i*%28%282pi%29%2F8%29*0%29%2B1*e%5E%28-i*%28%282pi%29%2F8%29*1%29%2B2*e%5E%28-i*%28%282pi%29%2F8%29*2%29%2B1*e%5E%28-i*%28%282pi%29%2F8%29*3%29%2B0*e%5E%28-i*%28%282pi%29%2F8%29*4%29-1*e%5E%28-i*%28%282pi%29%2F8%29*5%29-2*e%5E%28-i*%28%282pi%29%2F8%29*6%29-1*e%5E%28-i*%28%282pi%29%2F8%29*7.%29)
--->
<p><span class="math inline">\(X[2]=0\)</span></p>
<p><span class="math inline">\(X[...]=...\)</span></p>
<p><span class="math inline">\(X[7]=0+6.8284i\)</span></p>
<p>X=(0+0i, 0-6.8284i, -0+0i, -0+1.1716i,0+0i, 0-1.1716i, 0+0i, 0+6.8284i)</p>
<p>There are some common representations for the transformed signal which are often called Amplitude, Magnitude or Spectrum. The spectrum shows all frequencies which the signal contains and is calculated with <span class="math inline">\(\sphericalangle X(e^{j\omega})=arctan(\frac{Img\{H(e^{j\omega})\}}{Re\{H(e^{j\omega})\}})\)</span>. The Magnitude is the absolute value of any value, as opposed to its phase. For example the absolute value of <span class="math inline">\(|H(e^{j\omega})|=\sqrt{Re\{H(e^{j\omega})\}^2+Img\{H(e^{j\omega})\}^2}\)</span>.</p>
<p>Sources: &quot;Understanding Digital Signal Processing&quot; by Richard G. Lyons, Chapter 1.2 Signal Amplitude, Magnitude, Power</p>
<p>The amplitude can be calculated using the absolute value of the complex numbers of X.</p>
<p>X(amplitude)=(0, 6.8284, 4.4435e-16, 1.1715, 9.8607e-32, 1.1715, 3.8377e-15, 6.8284)</p>
<p>The phase can be calculated from the complex numbers of X.</p>
<p>X(phase)=( 0., -1.570796, 1.605601, 1.570796, 1.570796, -1.570796, 0.35452 , 1.570796)</p>
<div class="figure">
<img src="assets/img/blog/sip/discrete_signal_example_dft_amplitude_phase.png" alt="(Fig 13. amplitude and phase)" />
<p class="caption">(Fig 13. amplitude and phase)</p>
</div>
<p>Yet, we dealed with discrete signals (= frequency and time are discrete). For the case where the time is discrete but the frequency is continuos we use the term discrete-time (= time is discrete, frequency is continuous). The discrete fourier transformation for the discrete-time is defined as the following:</p>
<p>Letting <span class="math inline">\(N-&gt;\infty\)</span>, we obtain the discrete-time fourier transformation (frequency is continuous)</p>
<p><span class="math inline">\(X(\omega)=\sum_{\infty}^{n=-\infty} x[n]\cdot e^{-j\cdot\omega\cdot n}, \omega \in [0,2\pi] \qquad(analysis, dft, decomposition)\)</span></p>
<p><span class="math inline">\(x[n]=\frac{1}{2\pi}\cdot \int_{-\pi}^{\pi} X(\omega)\cdot e^{j\cdot\omega\cdot n} d\omega \qquad(inverse dft, synthesis)\)</span></p>
<p>Summary:</p>
<ul>
<li>DFT and inverse DFT transform between time and frequency domain without loss of information</li>
<li>DFT is not optimal for aperiodic signals
<ul>
<li>will result in artifacts</li>
<li>transient events (signal which occurs only in a certain time frame is also known as transient signal)</li>
</ul></li>
</ul>
<table style="width:72%;">
<colgroup>
<col width="19%" />
<col width="29%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="center">Periodic</th>
<th align="center">Non-periodioc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Discrete Time</td>
<td align="center">DT Fourier Series</td>
<td align="center">DT Fourier Transform</td>
</tr>
<tr class="even">
<td>DT analysis</td>
<td align="center"><span class="math inline">\(X[k]=\sum_{n=0}^{N-1} x[n]\cdot e^{-j\cdot\frac{2\pi\cdot k}{N}\cdot n}\)</span></td>
<td align="center"><span class="math inline">\(X(\omega)=\sum_{\infty}^{n=-\infty} x[n]\cdot e^{-j\cdot\omega\cdot n}, \omega \in [0,2\pi]\)</span></td>
</tr>
<tr class="odd">
<td>DT synthesis</td>
<td align="center"><span class="math inline">\(x[n]=\frac{1}{N}\cdot \sum_{k=0}^{N-1} X[k]\cdot e^{j\cdot\frac{2\pi\cdot k}{N}\cdot n}\)</span></td>
<td align="center"><span class="math inline">\(x[n]=\frac{1}{2\pi}\cdot \int_{-\pi}^{\pi} X(\omega)\cdot e^{j\cdot\omega\cdot n} d\omega\)</span></td>
</tr>
</tbody>
</table>
<h3 id="properties-of-discrete-fourier-transform">Properties of Discrete Fourier Transform</h3>
<h4 id="parsevals-theorem">Parseval's theorem</h4>
<p>The energy in both Domains (time and frequency) is the same</p>
<p><span class="math inline">\(\underbrace{\sum_{\infty}^{n=-\infty}| x[n] |^2}_{\substack{energy\\time\\domain}} =\underbrace{\frac{1}{2\cdot\pi}\int_{-\pi}^{\pi} |X(\omega)|^2 d\omega}_{\substack{energy\\frequency\\domain}}\)</span></p>
<p><a href="https://en.wikipedia.org/wiki/Parseval%27s_theorem">Parseval's theorem wiki</a></p>
<h4 id="convolution-theorem">Convolution theorem</h4>
<p>&quot;More generally, convolution in one domain (e.g., time domain) equals point-wise multiplication in the other domain (e.g., frequency domain)&quot; [Source https://en.wikipedia.org/wiki/Convolution_theorem]</p>
<p><span class="math inline">\(DTFT\{h[n]*x[n]\}=H(\omega)\cdot X(\omega)\)</span></p>
<h4 id="modulation-theorem">Modulation theorem</h4>
<p>The modulation theorem is some kind of a inverse convolution theorem. convolution in time domain is equivalent to a multiplication in frequency domain.<br />
multiplication in the time domain it will be a convolution in the frequency domain. multiplication in one domain is convolution in the other domain and visa verse.</p>
<p><span class="math inline">\(DTFT\{h[n]\cdot x[n]\}=H(\omega)* X(\omega)\)</span></p>
<h4 id="symmetries-in-the-dtft">Symmetries in the D(T)FT</h4>
<p><span class="math inline">\(X(\omega)=X(-\omega)^*\)</span></p>
<p><span class="math inline">\(|X(\omega)|=|X(-\omega)|\)</span></p>
<p><span class="math inline">\(\sphericalangle X(\omega) = - \sphericalangle X(-\omega)\)</span></p>
<p>for real valued signals the amplitudes of the negative frequencies are the same as the positive frequencies and the phases are symmetric. that means the positive frequencies contains all information about the spectrum.</p>
<p>Continue to <a href="blog/Signal%20sampling">Sampling</a></p>
<p>Sources:</p>
<ul>
<li>[transcript Signal and Image Processing lecture]</li>
<li><a href="http://www.songho.ca/dsp/convolution/convolution.html#definition2">[http://www.songho.ca/dsp/convolution/convolution.html#definition2]</a></li>
<li><a href="http://slpl.cse.nsysu.edu.tw/cpchen/courses/dsp/basics-2.pdf">[http://slpl.cse.nsysu.edu.tw/cpchen/courses/dsp/basics-2.pdf]</a></li>
<li><a href="http://docs.neu.edu.tr/staff/fahreddin.sadikoglu/3._2.pdf">[http://docs.neu.edu.tr/staff/fahreddin.sadikoglu/3._2.pdf]</a></li>
<li><a href="https://staff.fnwi.uva.nl/r.vandenboomgaard/SP20162017/LinearSystems/index.html">[https://staff.fnwi.uva.nl/r.vandenboomgaard/SP20162017/LinearSystems/index.html]</a></li>
<li><a href="http://www.dspguide.com/ch5/1.htm">[http://www.dspguide.com/ch5/1.htm]</a></li>
<li>transcript of course biosignal</li>
</ul>
