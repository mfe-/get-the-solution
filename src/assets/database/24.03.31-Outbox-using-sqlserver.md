Implement a message queue system using a SQL Server database. This system should allow multiple producers to enqueue messages into a specific table in the SQL Server database. The enqueuing operation should not rely on any external dependencies, such as Azure resources.

The message queue should support multiple consumer instances processing messages concurrently. These consumer instances are allowed to use additional resources, such as Azure resources, for processing the messages.

The system should ensure that each message in the queue is processed by only one consumer instance. Once a consumer instance has started processing a message, the system should prevent other consumer instances from processing the same message.

Identify or develop a C# library that provides the functionality to meet these requirements. The library should provide an API for enqueuing messages by the producers, starting consumer instances, and processing messages in the queue. It should also provide mechanisms for ensuring that each message is processed by only one consumer instance.

we publish around 1.300000-1.500000 events per day
peak time we publish around 8000 events per minute

Libaries:
- Rabbit.MQ
- [Rebus](https://github.com/rebus-org/Rebus/)
- MassTransit
- [CAP](https://github.com/dotnetcore/CAP) 

https://stackoverflow.com/questions/39466570/how-to-suspend-rebus-execution-while-another-process-is-locking-tables


https://github.com/rebus-org/Rebus.SqlServer/blob/fe8116f10e05fe1049a84a5658580d094b2bab47/Rebus.SqlServer/SqlServer/Transport/SqlServerTransport.cs#L370C1-L391C17


https://github.com/MassTransit/MassTransit/blob/de51cc910cd9c20f91a3b7165429a698c66bdd47/src/Transports/MassTransit.SqlTransport.SqlServer/SqlTransport/SqlServer/SqlServerDatabaseMigrator.cs#L728

https://github.com/dotnetcore/CAP/blob/710afff45e9e46439c8905d78c667ccafd7c7d0c/src/DotNetCore.CAP.SqlServer/IDataStorage.SqlServer.cs#L313C1-L316C1